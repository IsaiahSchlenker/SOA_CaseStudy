import numpy as np
import matplotlib.pyplot as plt
import scipy.stats as stats

# Paste your new data here
data = [
    13.7,27,31.5,4.8,23.4,4.5,6.3,61.7,7.5,7.3,38.5,5.4,6.8,65.4,91.2,15,16.8,7.1,33.7,5.4,54.5,7.4,75.9,25.8,7,7,85.8,3.6,20.3,24,8.9,6.3,14.7,9.5,6.9,47.3,83.8,47,8.2,47.4,5.8,13,8,25.3,15.6,4.2,63.4,23.3,26.4,8.6,8.1,8.5,8.8,29.1,61.1,92.7,7.8,53.9,23.2,21.4,73.2,26.4,67.6,4.4,4.9,7.8,16,17.1,4.6,22.7,5.2,4.3,59,29.1,33.3,9.3,3.9,47,5.4,3.1,8.4,8.9,5.5,39.5,3.8,7.4,78.4,71.3,8.5,58.5,9,81.7,8.2,28.5,93,9.5,50.9,5.5,3.5,93.9,7.8,12.8,27.9,38.3,8.2,30.6,6.9,4.2,11.1,9.4,6.5,30.4,3.9,56.4,65.7,26.1,44.8,8.5,43.9,54,43.6,6.9,6.9,4.8,9.1,8.2,87.1,23.5,8.1,3.5,8.3,8.7,9.4,23,3.5,26,6.2,37,92.3,60.9,4.6,16.9,7.9,92.4,7.3,8.2,13.1,31.6,6,4,8.1,4.1,26.6,7.3,2.6,33.8,3.9,9.4,47.6,3.4,7.5,39,7.8,26.1,6.9,73.7,6.4,26.9,13.8,26.8,38.8,93.9,52.2,9.2,23.8,29,7.1,61.1,9.2,4.8,43.5,3.5,25.6,33.9,17.9,39,8.2,4.1,19.5,13.9,9.5,68.7,45.6,8.6,6.2,25.2,16.2,38.5,8.3,3,8.2,5.4,7,18.3,3.7,9.1,42.1,20.7,8.7,16.3,7.5,51.7,34.7,47.4,71,8.6,4.7,8.4,4.1,62.8,9.1,7.9,5.5,5,3.8,3.4,15.3,11,28.2,8.3,48.1,8,26,9.2,15.1,12.9,8,22.3,7.9,5.5,3.1,71.9,31.3,8.1,4.9,3.6,6.8,5.4,9.4,4.4,5.1,9.5,31.1,3.7,9,7.2,7.6,8,8.2,29.8,46.9,7.7,7,3.4,6,9.1,8.8,4.1,4.3,4.5,40.3,8.1,7.9,3.8,3.1,16.7,7.1,8.4,4.4,4.9,4.5,5,18.4,62.9,26.3,45.4,5.3,6.7,4.1,2.9,7.7,3.7,25.1,21.9,9.2,8.5,5.9,5.4,9,7.1,43.6,6.2,3.6,7.3,3.9,6.7,8,3.9,3.6,49.3,7.8,4.1,4.7,56.7,47.6,25.3,4.5,72.4,7.8,3.1,9.1,4.8,38,16.1,45.9,35.6,7.8,4.9,33.8,22.3,7,3.9,9.1,7.9,4,5.9,8.4,6.2,6.6,4.3,4.1,3.8,3.9,67.4,59,7.8,3.2,55.8,3.4,33.4,9,25.4,6.2,5.9,8.3,5.8,5,63.5,7.1,7.6,30.3,33,6,5.6,2.9,5.3,8.4,70.3,70.3,8.1,7.4,5,5.5,7.4,4.1,7.2,6.7,23,7,4.2,7.6,7.5,5.4,9.2,4.6,4.9,8.9,60.4,9.2,8.4,6.4,3.6,7.2,4.6,34.3,21,31.1,4.4,8.2,6.2,3.1,8.4,21,18.1,8,35.7,32.2,7.5,4.7,7.2,5.1,13.2,28.1,31,6.4,5.4,62.9,8,7.6,9.5,6.9,6.7,19.8,4.7,30.9,70.7,7.3,6.6,31.8,46.4,8.5,43.1,7.1,6.2,29.5,9.1,6.3,4.4,3.4,26,3.7,7.2,9,7.3,18.3,46.7,6.2,17.1,2.8,5.8,4.3,6.7,7.2,52.4,69,11.6,9,7.2,9.4,8.9,4.4,3.8,9.3,25,21,57.2,3.6,4.9,46.2,20.3,42.4,4.7,4.4,30.7,3.5,8,49.2,6.4,6.2,6.2,3.6,9,38,7.2,3.6,3.7,6.4,6,5.6,40.2,4,8.3,14.4,51.6,5.7,63.4,63.4,7.5,5,5,18.4,9,68.6,3.2,5.4,6.3,5.4,3.7,10.5,23.5,20.4,4.2,4.2,3.5,16.7,14,64.3,67.1,36.8,5.6,64.8,46.7,3.7,10.1,4.6,7.3,5,4.3,6.4,45.3,5.1,3,5.9,8.2,7,10.1,43.6,3.7,7.3,7,64.5,12,56.7,7.3,4.1,48.9,16.5,3.4,7.4,56.8,6.9,3.2,66.9,48.4,5,3.2,6.3,6.7,33.5,3.6,2.9,36,68.4,40,7.2,3,9.1,7.6,6.1,36.9,3.4,6.9,54.3,3,17.8,9,41.9,3.9,56,9.1,33.3,9.1,4.9,31.8,31.5,47.6,3.8,4.6,66.7,8.6,13.4,51.6,45.9,4.4,54.7,26.7,49.6,38.1,33.7,9.2,5.3,3.6,4.5,6,5.7,6.5,8.2,3.7,7.9,7.1,5.3,7.1,5.7,52.2,44.3,5.6,28.3,4,65.7,5.3,8.7,3.1,5.6,4.9,7.9,6.8,7.3,42.2,9.2,9.4,70.5,6.9,4.9,5.9,8.8,3.1,9.1,55,4.4,44.8,9.3,3.1,8.8,7.3,9.1,30.7,3,9.3,64.3,5.6,8.2,5.6,21.9,7.5,5.9,59.1,5.3,51.6,3.3,4.3,8.5,3.2,18.2,23.3,4.8,7.1,4.4,8.2,3.3,5.8,50.1,3.6,63.8,4.4,7.1,46.3,40.5,4.5,4.8,9.2,44.2,6.5,8.8,6.2,15.1,5.2,9.3,3.6,60.3,4.9,38.5,49.4,3.7,8.9,3.6,7.3,3.8,3,6.1,43.8,3.7,17.4,6,3.6,6,7,7.3,5,4.3,6.9,62.5,44.6,3.3,14.9,4.3,4.8,3.3,6,17.2,8.3,8.1,7.5,8.3,4.3,7.7,3,7.2,35.4,28.7,9.5,61.2,3.5,7.9,4.7,41.1,55.3,27.8,3.5,4.2,32.3,6.1,8.6,6.3,5.3,9.5,3.1,62.6,4.4,5.5,8.6,8.7,5.4,5.8,3.4,5.1,11.3,6,9,5,4.5,18,55,3.7,6,8.4,6.8,8.5,67.8,10,68.3,5.5,26.4,51.2,62.3,3.6,3.2,18.9,35.3,8.7,6,8.9,3,7.8,5.4,53.9,32.7,10.5,5.5,9.2,41.3,2.9,6.7,27.7,3,27.5,4.1,8.2,17.6,51.1,6.6,4,3.2,3.7,40.7,3.2,41.5,9.2,9.3,8.5,3.8,7.3,8.2,7.5,8.8,8.6,4.8,5,7.1,5.1,6.9,9.1,43.8,9.5,5.5,6.6,6.5,9.5,5.7,3.7,6.5,8.3,47.3,19.6,10.4,9.5,7.5,8.7,4.7,5,3,70.8,7.5,41.3,69.2,8.2,9.4,7.2,51.7,68.3,16.6,8.8,4.1,4.8,4,47.4,14.8,5.8,7.7,4,8.5,3.9,8.1,8.3,5.9,6.3,6.2,55.8,48.9,6.8,4.8,46.8,6.3,3.2,20.1,7,7,27.5,4.5,8,5.2,9.5,9.4,15.2,14.8,15.1,8,12.6,15.1,4,24.3,8.1,27.7,8.7,3.2,5,8,5,3.6,8,13.2,36.2,10.9,8.2,8.8,4.9,4.7,19.4,4.4,64.7,4.9,38.6,33.7,2.9,37.4,8.3,7.1,5.1,4.8,4.8,18.9,68,21.1,3.6,50.3,7.3,65.9,8,8.6,5.1,47.8,7.3,4.1,8.2,8.9,13.2,24.5,9.2,17.7,4.6,6.8,60.7,8.9,39.8,20.8,5.7,5.7,24.9,6.6,8.2,6.8,9,6.7,27.5,7.3,10.8,5.9,7.9,6.8,42.1,70.6,17,14.7,5.6,57.1,7.7,38.5,7.1,6.5,5.6,3.5,6.1,4.3,8.8,4.6,47.9,65.5,4,6.2,64,5,8.9,6.9,4.2,3.2,5.7,3.4,9.8,6.2,13.3,39.2,6.2,8.2,5.5,5.8,9.4,50.1,64.2,4.7,9,56,48,5.9,7.5,51.9,7,48.1,26.1,7.3,61.8,9.1,52.1,25.2,4.1,6.5,6.9,28.8,6,4.7,6.9,3.2,8.6,9.2,46.3,3.1,9,4.3,9.1,3,3.8,4.2,6.2,56.5,37.6,4.1,43.9,55.1,22.1,7.4,7.1,4.9,33.5,3.4,46.5,7.5,9,4.6,12.1,4.7,20.9,3.5,10.6,4.7,6.2,5.1,35.5,36.2,7.1,5.4,3.4,23.2,5.6,49.8,6.2,7.6,7.8,9.1,3,7.4,8,64.8,8.2,7.5,52,6.6,3,9.4,7.4,4.8,6,20.9,42.2,8.4,57.7,3.3,3.4,4.9,9,5.4,6,6.7,7.3,65.8,5,47.5,6.4,4,14.8,8.6,3.6,3.3,65.4,9.4,3.6,14.4,6.9,48.2,5.4,49.6,51,7.3,9,6.2,67.3,8.1,6,3.6
]

# Calculate mean and variance from data
mean_data = np.mean(data)
var_data = np.var(data)

# For Lognormal distribution, we need to compute the parameters for the underlying normal distribution
# We know that:
# mean = exp(mu + sigma^2 / 2)
# variance = (exp(sigma^2) - 1) * exp(2*mu + sigma^2)
# Therefore, we can solve for mu and sigma using the given mean and variance.

# First, calculate the parameters of the underlying normal distribution
mu = np.log(mean_data**2 / np.sqrt(var_data + mean_data**2))
sigma = np.sqrt(np.log(1 + (var_data / mean_data**2)))

# Generate a range of values for plotting the PDF
x = np.linspace(min(data), max(data), 1000)
pdf_fitted = stats.lognorm.pdf(x, sigma, scale=np.exp(mu))

# Plot the histogram and fitted distribution
plt.hist(data, bins=30, density=True, alpha=0.6, color='g', label='Data Histogram')
plt.plot(x, pdf_fitted, 'r-', label=f'Fitted Lognormal\nmu: {mu:.2f}, sigma: {sigma:.2f}')
plt.xlabel('Value')
plt.ylabel('Density')
plt.title('Lognormal Fit to Data')
plt.legend()
plt.show()

# Print the mu and sigma parameters
print(f'Fitted Lognormal Parameters: mu={mu:.2f}, sigma={sigma:.2f}')
